define("mojo/mcneapolitan",["dojo/mccommon"],(function(e){return function(e){function t(t){for(var i,o,a=t[0],s=t[1],d=0,c=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&c.push(n[o][0]),n[o]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(r&&r(t);c.length;)c.shift()()}var i={},n={0:0};function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,o){i=n[e]=[t,o]}));t.push(i[2]=a);var s,d=document.createElement("script");d.charset="utf-8",d.timeout=120,o.nc&&d.setAttribute("nonce",o.nc),d.src=function(e){return o.p+"b626851fd5b785c2b9d1-"+({}[e]||e)+".js"}(e);var r=new Error;s=function(t){d.onerror=d.onload=null,clearTimeout(c);var i=n[e];if(0!==i){if(i){var o=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;r.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",r.name="ChunkLoadError",r.type=o,r.request=a,i[1](r)}n[e]=void 0}};var c=setTimeout((function(){s({type:"timeout",target:d})}),12e4);d.onerror=d.onload=s,document.head.appendChild(d)}return Promise.all(t)},o.m=e,o.c=i,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/release/1.1.1bd357cb175017ad5ec3f9077023183271844fb97/js-legacy/js/",o.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_name_=window.webpackJsonp_name_||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var r=s;return o(o.s=24)}([function(t,i){t.exports=e},function(e,t,i){e.exports=i(0)(0)},function(e,t,i){e.exports=i(0)(3)},function(e,t,i){e.exports=i(0)(1)},function(e,t,i){e.exports=i(0)(4)},function(e,t,i){e.exports=i(0)(11)},function(e,t,i){e.exports=i(0)(7)},function(e,t,i){e.exports=i(0)(8)},function(e,t,i){e.exports=i(0)(5)},function(e,t,i){e.exports=i(0)(10)},function(e,t,i){e.exports=i(0)(20)},function(e,t,i){e.exports=i(0)(26)},function(e,t,i){e.exports=i(0)(2)},function(e,t,i){e.exports=i(0)(15)},function(e,t,i){e.exports=i(0)(12)},function(e,t,i){e.exports=i(0)(1205)},function(e,t,i){var n,o;n=[i(1),i(11),i(17),i(57),i(58),i(3),i(6),i(4),i(18),i(59),i(7),i(5),i(2),i(19),i(8),i(12),i(13),i(20),i(21),i(60),i(22),i(61),i(23)],void 0===(o=function(e,t,i,n,o,a,s,d,r,c,l,p,h,u,m,g,f,v,b,y,_,w,k){return e([t,i,n],{feedbackUrl:null,campaignId:null,topicId:null,templateString:o,widgetsInTemplate:!0,replyString:'<div class="media border-bottom-light padding--lv3 !padding-left-right--lv0 !padding-top--lv0 margin--lv3 !margin-left-right--lv0 !margin-top--lv0"><img src="{created_by_avatar}" class="media-image border-radius--lv1" width="48" height="48" alt="{created_by_name}"><div class="media-body"><p class="!margin--lv0 fwb overflow-ellipsis">{created_by_name}</p><p class="!margin--lv0">{message}<span class="source-{source}"> (From: {source})</span></p><p class="!margin--lv0 small-meta dim-el">{created_at}</p></div></div>',topicString:'<p class="!margin--lv0 fwb overflow-ellipsis">{created_by_name}</p><p class="!margin--lv0">{message}<span class="source-{source}"> (From: {source})</span></p><p class="!margin--lv0 small-meta dim-el">{created_at}</p>',avatarString:'<img src="{created_by_avatar}" class="media-image border-radius--lv1" width="48" height="48"/>',postCreate:function(){var e=this;g(this.domNode,"a:click",(function(t){var i=l.get(this,"data-action-type");switch(i||window.open(t.target.href,"_blank"),t.preventDefault(),t.stopPropagation(),i){case"notifications":e.showNotifications();break;case"mark-completed":e._toggleCompleted(this);break;case"delete":var n=f.byId("comment-delete-dialog");n.onExecute=function(){n.hide(),e._deleteTopic(n)},n.show()}})),this.publishReady()},processMessage:function(e){return e=(e=(e=k.encode(e)).replace(/(https?:\/\/\S+)/gi,'<a href="$1" class="linkified">$1</a>')).replace(/(?:\r\n|\r|\n)/g,"<br />")},show:function(){var e=this;this.topicId?u.post(this.feedbackUrl+"/topic-detail",{data:{id:this.campaignId,feedback_id:this.topicId,socket_id:b.getSocketId()},handleAs:"json"}).then((function(t){p.set(e.loading,"display","none"),p.set(e.newTopicContainer,"display","none"),p.set(e.topicContainer,"display",""),t.topic.message=e.processMessage(t.topic.message),t.topic.created_by_name=k.encode(t.topic.created_by_name);var i=a.replace(e.topicString,t.topic);d.place(d.toDom(i),e.topic),d.place(d.toDom(a.replace(e.avatarString,a.mixin({w:54,h:54},t.topic))),e.creatorAvatar),d.place(d.toDom(a.replace(e.avatarString,{w:36,h:36,created_by_avatar:y.avatarUrl})),e.replyAvatar);var n=m(".js-feedback-item",e.topicContainer)[0];"Y"==t.topic.is_complete?(h.add(n,"done"),e.markCompletedLink.innerHTML="Mark Open"):(h.remove(n,"done"),e.markCompletedLink.innerHTML="Mark Completed"),s.forEach(t.replies,(function(t){t.message=e.processMessage(t.message),t.created_by_name=k.encode(t.created_by_name);var i=a.replace(e.replyString,t);d.place(d.toDom(i),e.replies,"last")}))})):(p.set(e.loading,"display","none"),p.set(e.topicContainer,"display","none"),p.set(e.newTopicContainer,"display",""),setTimeout((function(){e.newTopicMessage.focus()}),500))},showNotifications:function(){var e=this,t=f.byId("comment-notifications-dialog");t&&t.destroyRecursive(),new _({id:"comment-notifications-dialog",title:"Comment Notifications",style:"width:600px",href:e.feedbackUrl+"/feedback-notifications-dialog?id="+e.campaignId+"&feedback_id="+e.topicId,execute:function(){for(var t=m("input:checked","comment-notifications"),i=[],n=0;n<t.length;n++)i.push(t[n].value);u.post(e.feedbackUrl+"/set-feedback-notifications",{data:{id:e.campaignId,feedback_id:e.topicId,notifications:i.join(),socket_id:b.getSocketId()},handleAs:"json",sync:!0}).then((function(e){e.success&&f.byId("comment-notifications-dialog").hide()}))}}).show()},_deleteTopic:function(){var e=this;u.post(this.feedbackUrl+"/delete-feedback",{data:{id:this.campaignId,feedback_id:this.topicId,socket_id:b.getSocketId()},handleAs:"json"}).then((function(t){t.success&&(v.globalPublish("mojo/feedback/refresh"),e.done())}))},_toggleCompleted:function(e){u.post(this.feedbackUrl+"/toggle-feedback-completed",{data:{id:this.campaignId,feedback_id:this.topicId,socket_id:b.getSocketId()},handleAs:"json"}).then((function(t){var i=m(e).parents(".js-feedback-item")[0];t.is_complete?(h.add(i,"done"),e.innerHTML="Mark Open"):(h.remove(i,"done"),e.innerHTML="Mark Completed")}))},_onDone:function(e){c.stop(e),v.globalPublish("mojo/feedback/refresh",{}),this.done()},_addComment:function(e){c.stop(e);var t=this;u.post(this.feedbackUrl+"/reply-add",{data:{id:this.campaignId,feedback_id:this.topicId,message:this.message.value,socket_id:b.getSocketId()},handleAs:"json"}).then((function(e){e.reply.message=t.processMessage(e.reply.message),e.reply.created_by_name=k.encode(e.reply.created_by_name);var i=a.replace(t.replyString,e.reply);d.place(d.toDom(i),t.replies,"last"),t.message.value=""}))},_addTopic:function(e){c.stop(e);var t=this;u.post(this.feedbackUrl+"/add-feedback",{data:{id:this.campaignId,message:this.newTopicMessage.value,socket_id:b.getSocketId()},handleAs:"json"}).then((function(e){t.topicId=e.id,t.show()}))}})}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(41)},function(e,t,i){e.exports=i(0)(64)},function(e,t,i){e.exports=i(0)(19)},function(e,t,i){e.exports=i(0)(16)},function(e,t,i){e.exports=i(0)(72)},function(e,t,i){e.exports=i(0)(31)},function(e,t,i){e.exports=i(0)(39)},function(e,t,i){e.exports=i},function(e,t,i){e.exports=i(0)(339)},function(e,t,i){e.exports=i(0)(275)},function(e,t,i){var n,o;n=[i(28),i(6),i(1),i(29),i(9),i(7),i(2),i(4),i(30),i(31),i(3),i(32),i(10),i(33),i(34),i(35),i(11),i(36),i(14),i(37),i(38),i(39),i(40),i(41)],void 0===(o=function(e,t,n,o,a,s,d,r,c,l,p,h,u,m,g,f,v,b,y,_,w,k,x){var j=n("dijit.layout._AccordionButton",[v,y,_],{templateString:x,label:"",_setLabelAttr:{node:"titleTextNode",type:"innerHTML"},title:"",_setTitleAttr:{node:"titleTextNode",type:"attribute",attribute:"title"},iconClassAttr:"",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitAccordionTitle",getParent:function(){return this.parent},buildRendering:function(){this.inherited(arguments);var e=this.id.replace(" ","_");s.set(this.titleTextNode,"id",e+"_title"),this.focusNode.setAttribute("aria-labelledby",s.get(this.titleTextNode,"id")),a.setSelectable(this.domNode,!1)},getTitleHeight:function(){return c.getMarginSize(this.domNode).h},_onTitleClick:function(){this.getParent().selectChild(this.contentWidget,!0),m.focus(this.focusNode)},_onTitleKeyDown:function(e){return this.getParent()._onKeyDown(e,this.contentWidget)},_setSelectedAttr:function(e){this._set("selected",e),this.focusNode.setAttribute("aria-expanded",e?"true":"false"),this.focusNode.setAttribute("aria-selected",e?"true":"false"),this.focusNode.setAttribute("tabIndex",e?"0":"-1")}});var C=n("dijit.layout._AccordionInnerContainer",[v,_],{baseClass:"dijitAccordionInnerContainer",isLayoutContainer:!0,buildRendering:function(){this.domNode=r.place("<div class='"+this.baseClass+"' role='presentation'>",this.contentWidget.domNode,"after");var e=this.contentWidget,t=p.isString(this.buttonWidget)?p.getObject(this.buttonWidget):this.buttonWidget;this.button=e._buttonWidget=new t({contentWidget:e,label:e.title,title:e.tooltip,dir:e.dir,lang:e.lang,textDir:e.textDir||this.textDir,iconClass:e.iconClass,id:e.id+"_button",parent:this.parent}).placeAt(this.domNode),this.containerNode=r.place("<div class='dijitAccordionChildWrapper' role='tabpanel' style='display:none'>",this.domNode),this.containerNode.setAttribute("aria-labelledby",this.button.id),r.place(this.contentWidget.domNode,this.containerNode)},postCreate:function(){this.inherited(arguments);var e=this.button,t=this.contentWidget;this._contentWidgetWatches=[t.watch("title",p.hitch(this,(function(t,i,n){e.set("label",n)}))),t.watch("tooltip",p.hitch(this,(function(t,i,n){e.set("title",n)}))),t.watch("iconClass",p.hitch(this,(function(t,i,n){e.set("iconClass",n)})))]},_setSelectedAttr:function(e){if(this._set("selected",e),this.button.set("selected",e),e){var t=this.contentWidget;t.onSelected&&t.onSelected()}},startup:function(){this.contentWidget.startup()},destroy:function(){this.button.destroyRecursive(),t.forEach(this._contentWidgetWatches||[],(function(e){e.unwatch()})),delete this.contentWidget._buttonWidget,delete this.contentWidget._wrapperWidget,this.inherited(arguments)},destroyDescendants:function(e){this.contentWidget.destroyRecursive(e)}});var I=n("dijit.layout.AccordionContainer",w,{duration:g.defaultDuration,buttonWidget:j,baseClass:"dijitAccordionContainer",buildRendering:function(){this.inherited(arguments),this.domNode.style.overflow="hidden",this.domNode.setAttribute("role","tablist")},startup:function(){this._started||(this.inherited(arguments),this.selectedChildWidget&&this.selectedChildWidget._wrapperWidget.set("selected",!0))},layout:function(){var e=this.selectedChildWidget;if(e){var i=e._wrapperWidget.domNode,n=c.getMarginExtents(i),o=c.getPadBorderExtents(i),a=e._wrapperWidget.containerNode,s=c.getMarginExtents(a),d=c.getPadBorderExtents(a),r=this._contentBox,l=0;t.forEach(this.getChildren(),(function(t){t!=e&&(l+=c.getMarginSize(t._wrapperWidget.domNode).h)})),this._verticalSpace=r.h-l-n.h-o.h-s.h-d.h-e._buttonWidget.getTitleHeight(),this._containerContentBox={h:this._verticalSpace,w:this._contentBox.w-n.w-o.w-s.w-d.w},e&&e.resize(this._containerContentBox)}},_setupChild:function(e){e._wrapperWidget=C({contentWidget:e,buttonWidget:this.buttonWidget,id:e.id+"_wrapper",dir:e.dir,lang:e.lang,textDir:e.textDir||this.textDir,parent:this}),this.inherited(arguments),r.place(e.domNode,e._wrapper,"replace")},removeChild:function(e){e._wrapperWidget&&(r.place(e.domNode,e._wrapperWidget.domNode,"after"),e._wrapperWidget.destroy(),delete e._wrapperWidget),d.remove(e.domNode,"dijitHidden"),this.inherited(arguments)},getChildren:function(){return t.map(this.inherited(arguments),(function(e){return"dijit.layout._AccordionInnerContainer"==e.declaredClass?e.contentWidget:e}),this)},destroy:function(){this._animation&&this._animation.stop(),t.forEach(this.getChildren(),(function(e){e._wrapperWidget?e._wrapperWidget.destroy():e.destroyRecursive()})),this.inherited(arguments)},_showChild:function(e){return e._wrapperWidget.containerNode.style.display="block",this.inherited(arguments)},_hideChild:function(e){e._wrapperWidget.containerNode.style.display="none",this.inherited(arguments)},_transition:function(e,t,i){h("ie")<8&&(i=!1),this._animation&&(this._animation.stop(!0),delete this._animation);var n=this;if(e){e._wrapperWidget.set("selected",!0);var a=this._showChild(e);this.doLayout&&e.resize&&e.resize(this._containerContentBox)}if(t&&(t._wrapperWidget.set("selected",!1),i||this._hideChild(t)),i){var s=e._wrapperWidget.containerNode,d=t._wrapperWidget.containerNode,r=e._wrapperWidget.containerNode,l=c.getMarginExtents(r),p=c.getPadBorderExtents(r),u=l.h+p.h;d.style.height=n._verticalSpace-u+"px",this._animation=new o.Animation({node:s,duration:this.duration,curve:[1,this._verticalSpace-u-1],onAnimate:function(e){e=Math.floor(e),s.style.height=e+"px",d.style.height=n._verticalSpace-u-e+"px"},onEnd:function(){delete n._animation,s.style.height="auto",t._wrapperWidget.containerNode.style.display="none",d.style.height="auto",n._hideChild(t)}}),this._animation.onStop=this._animation.onEnd,this._animation.play()}return a},_onKeyDown:function(e,t){if(!this.disabled&&!e.altKey&&(t||e.ctrlKey)){var i=e.keyCode;t&&(i==l.LEFT_ARROW||i==l.UP_ARROW)||e.ctrlKey&&i==l.PAGE_UP?(this._adjacent(!1)._buttonWidget._onTitleClick(),e.stopPropagation(),e.preventDefault()):(t&&(i==l.RIGHT_ARROW||i==l.DOWN_ARROW)||e.ctrlKey&&(i==l.PAGE_DOWN||i==l.TAB))&&(this._adjacent(!0)._buttonWidget._onTitleClick(),e.stopPropagation(),e.preventDefault())}}});return h("dijit-legacy-requires")&&f(0,(function(){i.e(1).then((function(){i(79)})).catch(i.oe)})),I._InnerContainer=C,I._Button=j,I}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(42)},function(e,t,i){e.exports=i(0)(54)},function(e,t,i){e.exports=i(0)(28)},function(e,t,i){e.exports=i(0)(32)},function(e,t,i){e.exports=i(0)(34)},function(e,t,i){e.exports=i(0)(61)},function(e,t,i){e.exports=i(0)(142)},function(e,t,i){e.exports=i(0)(40)},function(e,t,i){e.exports=i(0)(153)},function(e,t,i){e.exports=i(0)(179)},function(e,t,i){e.exports=i(0)(1124)},function(e,t,i){e.exports=i(0)(103)},function(e,t){e.exports="<div data-dojo-attach-event='ondijitclick:_onTitleClick' class='dijitAccordionTitle' role=\"presentation\">\n\t<div data-dojo-attach-point='titleNode,focusNode' data-dojo-attach-event='onkeydown:_onTitleKeyDown'\n\t\t\tclass='dijitAccordionTitleFocus' role=\"tab\" aria-expanded=\"false\"\n\t\t><span class='dijitInline dijitAccordionArrow' role=\"presentation\"></span\n\t\t><span class='arrowTextUp' role=\"presentation\">+</span\n\t\t><span class='arrowTextDown' role=\"presentation\">-</span\n\t\t><span role=\"presentation\" class=\"dijitInline dijitIcon\" data-dojo-attach-point=\"iconNode\"></span>\n\t\t<span role=\"presentation\" data-dojo-attach-point='titleTextNode, textDirNode' class='dijitAccordionText'></span>\n\t</div>\n</div>\n"},function(e,t,i){e.exports=i(0)(81)},function(e,t,i){e.exports=i(0)(702)},function(e,t,i){e.exports=i(0)(1174)},function(e,t,i){e.exports=i(0)(2321)},function(e,t,i){e.exports=i(0)(2312)},function(e,t,i){e.exports=i(0)(2322)},function(e,t,i){e.exports=i(0)(2323)},function(e,t,i){e.exports=i(0)(2189)},function(e,t,i){e.exports=i(0)(2073)},function(e,t,i){e.exports=i(0)(1059)},function(e,t,i){e.exports=i(0)(1058)},function(e,t,i){e.exports=i(0)(1173)},function(e,t,i){var n,o;n=[i(9),i(54)],void 0===(o=function(e,t){return new t("neapolitan-coachmark",{step1:{message:"Drag any of the blocks below into the campaign preview on the left. Go ahead, try dragging a <strong>text block</strong> to the top of your campaign.",placement:e.byId("blocks-container"),completesOn:"neapolitan/blocks/text/dropped"},step2:{message:"Once you've dropped in a block, its editor appears in the right column. Most blocks have editable Content, Style and Settings options. Try changing something in the Style tab.",arrow:"right",placement:e.byId("previewcol"),dependsOn:["step1"],completesOn:"neapolitan/blocks/style/changed"},step3:{message:"Changes in the Style tab can be applied to all blocks of the same type. When you're done, click the Save & Close button below.",placement:e.byId("toolcol"),dependsOn:["step2"],completesOn:"mojo/editor/done"},step4:{message:"Mouse over blocks to access the editor. You'll also find options to reorder, duplicate, and delete the block. Try dragging the reorder icon on a block to change its position.",arrow:"left",placement:e.byId("previewcol"),dependsOn:["step3"],completesOn:"neapolitan/blocks/reorder"},step5:{message:"As you edit your campaign, it's a good idea to test it out. In the Preview & Test menu above, click Enter preview mode.",arrow:"up",placement:e.byId("toolcol"),dependsOn:["step4"],completesOn:"#showPreview:click"},step6:{message:"Every campaign created in our new editor is mobile-friendly and adapts to fit small screens (in email clients that support media queries). Our side-by-side preview mode lets you  see how your email will look in both desktop and mobile environments. Click the &times; to exit Preview Mode.",arrow:"none",placement:e.byId("mobile-preview"),dependsOn:["step5"],completesOn:".close-preview:click"},step7:{message:"There's a lot more to see in the new editor, like these <a href='#' onclick='window.toggleHotkeyHelpPane(); return false;'>keyboard shortcuts</a>, but we'll let you explore. We're still improving it so please <a target='_blank' href='https://mailchimp.wufoo.com/forms/feedback-about-the-new-mailchimp-editor/'>send us your feedback</a>.",arrow:"none",placement:e.byId("blocks-container"),dependsOn:["step6"],endStep:!0}})}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(2279)},function(e,t,i){var n,o;n=[i(1),i(56),i(16),i(3),i(6),i(8),i(9),i(7),i(5),i(2),i(4),i(19),i(21),i(12),i(62),i(13),i(10),i(20),i(63),i(22),i(64),i(23)],void 0===(o=function(e,t,i,n,o,a,s,d,r,c,l,p,h,u,m,g,f,v,b,y,_,w){return e([t],{templateString:m,itemTemplateString:'<li class="c-feedbackItem media js-feedback-item"><div id="{id}" data-action-type="feedback-item"><div class="feedbackItem__inner"><img src="{created_by_avatar}" class="media-image border-radius--lv1" width="48" height="48" alt="{created_by_name}" /><div class="media-body"><p class="!margin--lv0 fwb overflow-ellipsis">{created_by_name} <span class="badge">{num_replies}</span></p><div class="c-commentMessageSummary">{message}</div><p class="!margin--lv0 small-meta dim-el">{created_at}</p></div></div></div></li>',badgeString:'<span class="badge notification p0 margin--lv2 !margin-top-bottom--lv0 !margin-right--lv0" id="comments-unread-count" style="display:none;"></span>',pushChannel:null,postCreate:function(){var e=s.byId("feedback-link");if(!e)throw Error("Can't find comments tab link to append the comments count badge to.");this.badge=l.place(this.badgeString,e),this.noDataWidget=new _({type:"comments"},this.noFeedbackBlock),c.add(this.noDataWidget.domNode,"noborder"),this.showTopics(),f.subscribe("mojo/feedback/refresh",n.hitch(this,(function(){this.showTopics()}))),this._connectToPusher();var t=this;this.own(u(this.domNode,".js-feedback-item > div:click",(function(e){e.preventDefault(),e.stopPropagation(),"feedback-item"==d.get(this,"data-action-type")&&t.showFeedbackItem(this.id)})),u(this.noDataWidget.sendTestLink,"click",(function(e){e.preventDefault(),e.stopPropagation(),b.showSendTestDialog()})))},_connectToPusher:function(){this.pushChannel&&h.load().then(n.hitch(this,(function(e){(e.channels.channels[this.pushChannel]?e.channels.channels[this.pushChannel]:e.subscribe(this.pushChannel)).bind("change",n.hitch(this,(function(e){e.campaign_id==this.campaignId&&v.globalPublish("mojo/feedback/refresh",{})})))})))},showFeedbackItem:function(e){var t=new i;t.topicId=e,t.feedbackUrl=this.feedbackUrl,t.campaignId=this.campaignId,t.show()},showNotifications:function(){var e=this,t=g.byId("comment-notifications-dialog");t&&t.destroyRecursive(),new y({id:"comment-notifications-dialog",title:"Comment Notifications",style:"width:600px",href:e.feedbackUrl+"/feedback-notifications-dialog?id="+e.campaignId,execute:function(){var t=[];a("input:checked","comment-notifications").forEach((function(e){t.push(e.value)})),p.post(e.feedbackUrl+"/set-feedback-notifications",{data:{id:e.campaignId,notifications:t.join()},handleAs:"json",sync:!0}).then((function(e){e.success&&g.byId("comment-notifications-dialog").hide()}))}}).show()},newTopic:function(e){e.preventDefault();var t=new i;t.feedbackUrl=this.feedbackUrl,t.campaignId=this.campaignId,t.show()},showUnreadTopicsCount:function(e){var t=0;o.forEach(e,n.hitch(this,(function(e){"N"==e.is_read&&(t+=1),t+=e.unread_replies}))),t>0?(r.set(this.badge,"display","inline"),this.badge.innerHTML=t):r.set(this.badge,"display","none")},processMessage:function(e){return e=(e=(e=w.encode(e)).replace(/(https?:\/\/\S+)/gi,'<a href="$1" class="linkified">$1</a>')).replace(/(?:\r\n|\r|\n)/g,"<br />")},showTopics:function(){var e=this;p.post(this.feedbackUrl+"/topics",{data:{id:this.campaignId},handleAs:"json",sync:!0}).then((function(t){if(e.showUnreadTopicsCount(t),t&&0!==t.length){r.set(e.noFeedbackBlock,"display","none"),r.set(e.allFeedback,"display",""),l.empty(e.completedNav),l.empty(e.uncompletedNav);for(var i=0,n=0;n<t.length;n++){e.mainNav="Y"==t[n].is_complete?e.completedNav:e.uncompletedNav,t[n].message=e.processMessage(t[n].message),t[n].created_by_name=w.encode(t[n].created_by_name);var o=e.addNavItem(t[n]);if("Y"==t[n].is_complete&&(c.add(o,"done"),i++),"Y"!=t[n].is_read?c.add(o,"unread"):t[n].unread_replies>0&&c.add(o,"newreply"),0===t[n].num_replies)r.set(a("span.badge",o)[0],"display","none");else if(1==t[n].num_replies){a("span.badge",o)[0].innerHTML="1"}}i>0?r.set(s.byId("completed-feedback-list"),"display",""):r.set(s.byId("completed-feedback-list"),"display","none")}else r.set(e.noFeedbackBlock,"display",""),r.set(e.allFeedback,"display","none")}))}})}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(761)},function(e,t,i){e.exports=i(0)(150)},function(e,t){e.exports='<div>\n    <div data-dojo-attach-point="loading">\n        <div class="loadingbar alignc">Please wait, loading...</div>\n    </div>\n\n    <div class="feedback-editor" data-dojo-attach-point="newTopicContainer" style="display: none;">\n        <div class="drillnavbar alignc border-bottom">\n            <h4>New Comment</h4>\n            <a class="button-small drillback imgrpl-inline" href="#" data-dojo-attach-event="onclick:_onDone"><span class="freddicon arrow-left"></span></a>\n        </div>\n        <div class="padding--lv3">\n            <textarea data-dojo-attach-point="newTopicMessage" class="newTopicMessage"></textarea>\n            <button class="button p0" data-dojo-attach-event="onclick:_addTopic">Add Comment</button>\n            <a href="#" data-dojo-attach-event="onclick:_onDone" class="small-meta fwb">Cancel</a>\n        </div>\n    </div>\n\n    <div class="feedback-editor" data-dojo-attach-point="topicContainer" style="display: none;">\n        <div class="drillnavbar alignc border-bottom">\n            <h4>Comments</h4>\n            <a class="button-small drillback imgrpl-inline" href="#" data-dojo-attach-event="onclick:_onDone"><span class="freddicon arrow-left"></span></a>\n        </div>\n\n        <div class="editorscroll">\n            <div class="media padding--lv3 border-bottom-light js-feedback-item">\n                <div data-dojo-attach-point="creatorAvatar"></div>\n                <div class="media-body">\n                    <div data-dojo-attach-point="topic"></div>\n                    <ul class="small-meta linear-list dots selfclear section !margin--lv0">\n                        <li><a href="#" data-action-type="notifications">Notifications</a></li>\n                        <li><a href="#" data-action-type="mark-completed" data-dojo-attach-point="markCompletedLink"></a></li>\n                        <li><a href="#" data-action-type="delete">Delete</a></li>\n                    </ul>\n                </div>\n            </div>\n            <div class="padding--lv3">\n                <div data-dojo-attach-point="replies"></div>\n                <div class="media">\n                    <div data-dojo-attach-point="replyAvatar"></div>\n                    <div class="media-body">\n                        <textarea class="minh-lv6" placeholder="Enter your reply here." data-dojo-attach-point="message"></textarea>\n                        <button class="button p0" data-dojo-attach-event="onclick:_addComment">Add Comment</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t,i){e.exports=i(0)(67)},function(e,t,i){e.exports=i(0)(17)},function(e,t,i){e.exports=i(0)(83)},function(e,t){e.exports='<div>\n    <div class="editorscroll editorscroll--noPanel">\n        <div data-dojo-attach-point="allFeedback" style="display:none">\n            <div id="feedback-list" data-dojo-attach-point="feedbackList">\n                <ul data-dojo-attach-point="uncompletedNav" class="drillnav block relative"></ul>\n            </div>\n            <div id="completed-feedback-list" style="display:none;">\n                <ul data-dojo-attach-point="completedNav" class="drillnav block relative"></ul>\n            </div>\n        </div>\n        <div id="no-feedback-block" data-dojo-attach-point="noFeedbackBlock" class="alignc"></div>\n    </div>\n    <div class="c-actionButtonsPane">\n        <button class="button p0" data-dojo-attach-event="onclick:newTopic">Add a Comment</button>\n        <a href="#" data-dojo-attach-event="onclick:showNotifications" class="small-meta fwb">Notifications</a>\n    </div>\n</div>\n'},function(e,t,i){e.exports=i(0)(101)},function(e,t,i){e.exports=i(0)(230)},function(e,t,i){var n,o;n=[i(1),i(11),i(17),i(66),i(3),i(5),i(4),i(2),i(67),i(68),i(69)],void 0===(o=function(e,t,i,n,o,a,s,d,r,c,l){return e([t,i],{templateString:l,viewerRowString:'<li class="viewer"><img class="userColor float-left border-radius--lv1" width="18" height="18" src={avatar}> {name}</li>',postCreate:function(){this._refreshMemberList(),r.convert(this.domNode),c.after(this.app,"addViewer",o.hitch(this,this._refreshMemberList)),c.after(this.app,"removeViewer",o.hitch(this,this._refreshMemberList))},_refreshMemberList:function(){s.empty(this.viewerList);var e=this.app.viewers,t=this.app.viewerCount;if(t>1){this.status;for(var i in n.set(this.status,t+" Editing"),a.set(this.domNode,"display",""),s.place('<li class="title"><strong>Currently Editing:</strong></li>',this.viewerList),e){var d=e[i],r=d.name+(d.me?" (You)":"");s.place(o.replace(this.viewerRowString,{name:r,avatar:d.avatar}),this.viewerList)}}else a.set(this.domNode,"display","none")}})}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(29)},function(e,t,i){e.exports=i(0)(719)},function(e,t,i){e.exports=i(0)(36)},function(e,t){e.exports='<ul class="hover-list click-to-open viewer-list inline vbar">\n    <li class="inline">\n        <a class="viewer-status" href="#" data-dojo-attach-point="status"></a>\n        <ul class="right-edge" style="width:200px;" data-dojo-attach-point="viewerList"></ul>\n    </li>\n</ul>'},function(e,t,i){var n,o;n=[i(1),i(3),i(5),i(8),i(10),i(71),i(2),i(72),i(15)],void 0===(o=function(e,t,i,n,o,a,s,d,r){return e([r],{ckEditorToggleHandler:null,ckEditorResizeHandler:null,postCreate:function(){this.inherited(arguments),this.ckEditorToggleHandler=o.subscribe("current/block/editor/toggle/ckeditor/mode",t.hitch(this,this._toggleCKEditMode))},destroy:function(){this.inherited(arguments),this.ckEditorToggleHandler.remove()},_defaultContainerStyles:function(){i.set(this.container,{width:"100%",height:"100%",position:"static",left:0,top:0,bottom:0,overflow:"initial",background:"#ffffff"})},_toggleCKEditMode:function(e){e.isEditMode?this._ckFocusContainerStyles():this._defaultContainerStyles()},_ckFocusContainerStyles:function(e){i.set(this.container,{position:"static",height:"inherit"})},_show:function(e){var t=new a;return n("body").addClass("open-drawer"),document.getElementById("previewcol").style.display="none",e?this._showAnimation().then((function(){t.resolve()})):(i.set(this.domNode,"display","block"),t.resolve()),t},_showAnimation:function(){var e=new a;i.set(this.domNode,{display:"block"});this.domNode.offsetHeight;return e.promise},_hide:function(e){var o=new a;return n("#content-link.active").length&&n("body:not(.slider-editor)").removeClass("open-drawer"),e?(document.getElementById("previewcol").style.display="block",s.add(this.domNode,"editorPaneHiding"),this._hideAnimation().then(t.hitch(this,(function(){this._hide(!1),s.remove(this.domNode,"editorPaneHiding"),o.resolve()})))):(i.set(this.domNode,"display","none"),o.resolve()),o},_hideAnimation:function(){var e=new a;return e.resolve(),e.promise}})}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(24)},function(e,t,i){e.exports=i(0)(37)},function(e,t,i){var n,o;n=[i(1),i(74),i(14),i(75),i(76),i(12),i(3),i(18),i(4),i(5),i(2),i(7),i(6),i(8),i(13),i(77),i(78)],void 0===(o=function(e,t,i,n,o,a,s,d,r,c,l,p,h,u,m,g,f){return e([t,i],{templateString:n,templateStringMobile:o,baseClass:"mojoImageList",maxImages:null,minImages:1,isMobile:!1,imagesRows:null,postMixInProperties:function(){this.images?this.images=s.clone(this.images):this.images=[],this.imageRows=[]},render:function(){var e=this;this.multipleImages=this.images.length>1,h.forEach(this.images,s.hitch(this,(function(e,t){this._appendImage(t,e)}))),h.forEach(this.imageRows,(function(t){t.toggleDragHandle(e.multipleImages),t.setActions(e._getRowActions())}))},toggleUploadMessage:function(e){c.set(this.uploadOverlay,"display",e?"block":"")},constructor:function(e){e.isMobile&&(this.isMobile=e.isMobile,this.templateString=this.templateStringMobile)},postCreate:function(){var e=this;this.watch("images",s.hitch(this,(function(){this.render(),this._triggerDndSync(),this._checkAddButton()}))),this.render(),this.isMobile||(this.dndSource=new g(this.imageList,{withHandles:!0,singular:!0,accept:"dndImageListItem"}),this.connect(this.dndSource,"onDropInternal",(function(){this.imageRows=[];var t=[];h.forEach(this.dndSource.getAllNodes(),(function(i){var n=m.byNode(i);e.imageRows.push(n),t.push(n.image)})),this.images=t,this.onChange("reorder")}))),this.connect(this.addBtn,"click",(function(e){e.stopPropagation(),e.preventDefault(),this.addImage(null)})),this._checkAddButton()},addImage:function(e){this._appendImage(this.images.length,e),this.images.push(e),this.images.length>this.minImages&&this.render(),this._triggerDndSync(),this._checkAddButton(),this.onChange("image")},updateImage:function(e,t){this.images[e]=t,this._appendImage(e,t),this._triggerDndSync()},removeImage:function(e){this.imageRows[e].destroy(),this.imageRows.splice(e,1),this.images.splice(e,1),this.images.length===this.minImages&&this.render(),this._triggerDndSync(),this._checkAddButton(),this.onChange("image")},_checkAddButton:function(){this.maxImages&&this.images.length>=this.maxImages?c.set(this.addBtn,"display","none"):c.set(this.addBtn,"display","block")},_appendImage:function(e,t){if(this.imageRows[e])this.imageRows[e].updateImage(t);else{var i=new f({image:t,actions:this._getRowActions(),isMobile:this.isMobile,renderingType:this.renderingType});i.startup(),this.imageRows[e]=i,i.on("change",s.hitch(this,(function(e){var t=this.imageRows.indexOf(i);i.image&&this.updateImage(t,i.image),this.onChange(e)}))),i.on("remove",s.hitch(this,(function(){var e=this.imageRows.indexOf(i);this.removeImage(e)}))),r.place(i.domNode,this.imageList)}},_getRowActions:function(){var e=["edit","link","alt"];return this.isMobile&&(e=["link","alt"]),this.images.length>this.minImages&&e.push("remove"),e},_triggerDndSync:function(){this.isMobile||this.dndSource.sync()},onChange:function(e){}})}.apply(t,n))||(e.exports=o)},function(e,t,i){e.exports=i(0)(13)},function(e,t){e.exports='<div class="relative">\n\n    <div class=\'mojoImageList\' data-dojo-attach-point="imageList"></div>\n\n    <div class="margin--lv4 margin-top-bottom--lv0" data-dojo-attach-point="addBtn">\n        <div class="margin--lv2 !margin-left-right--lv0 alignc">\n            <button class="button">Add Another Image</button>\n        </div>\n    </div>\n\n    <div data-dojo-attach-point="uploadOverlay" class="mojoImageListOverlay alignc absolute pos-tb0 pos-lr0 padding--lv5 !padding-left-right--lv0">\n        <p class="!margin--lv0 full-width fwb dim-el">We\'re uploading your image now.</p>\n        <img src="https://cdn-images.mailchimp.com/product/loading_bar.gif" class="border-radius--lv1" />\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="relative">\n\n    <div class=\'mojoImageList mojoItems--mobile\' data-dojo-attach-point="imageList"></div>\n\n    <div class="margin--lv4 margin-top-bottom--lv0" data-dojo-attach-point="addBtn">\n        <div class="margin--lv2 !margin-left-right--lv0 alignc">\n            <button class="button">Add Another Image</button>\n        </div>\n    </div>\n\n    <div data-dojo-attach-point="uploadOverlay" class="mojoImageListOverlay alignc absolute pos-tb0 pos-lr0 padding--lv5 !padding-left-right--lv0">\n        <p class="!margin--lv0 full-width fwb dim-el">We\'re uploading your image now.</p>\n        <img src="https://cdn-images.mailchimp.com/product/loading_bar.gif" class="border-radius--lv1" />\n    </div>\n</div>\n'},function(e,t,i){e.exports=i(0)(120)},function(e,t,i){e.exports=i(0)(811)}])})),function(){function e(e){return function(){define(["mojo/mcneapolitan"],(function(t){return t(e)}))}}var t={"mojo/neapolitan/editors/FeedbackEditor":e("16"),"dijit/layout/AccordionContainer":e("27"),"dijit/layout/templates/AccordionButton.html":e("40"),"mojo/neapolitan/TourCoachmarks":e("53"),"mojo/neapolitan/FeedbackPane":e("55"),"mojo/neapolitan/editors/templates/feedbackEditor.html":e("58"),"mojo/neapolitan/templates/feedbackPane.html":e("62"),"mojo/neapolitan/widgets/ViewerList":e("65"),"mojo/neapolitan/widgets/templates/viewerList.html":e("69"),"mojo/neapolitan/mobile/EditorPane":e("70"),"mojo/neapolitan/widgets/ImageList":e("73"),"mojo/neapolitan/widgets/templates/imageList.html":e("75"),"mojo/neapolitan/widgets/templates/imageListMobile.html":e("76")};require({cache:t}),require({cache:{}}),require(Object.keys(t),(function(){}))}();